@use "sass:map";
@use "sass:meta";
@use "../../mixins/index.scss" as *;
@use "../../functions/index.scss" as *;
@use "../../color-system/_functions.scss" as *;
@use "../../_variables.scss" as *;
@use "./_variables.scss" as *;

@mixin kendo-button-theme-colors-controller($theme-colors, $default-theme-color: md) {
    .k-button {
        --kendo-button-theme-color: #{k-color(#{$default-theme-color})};
        --kendo-button-on-theme-color: #{k-color(on-#{$default-theme-color})};
        --kendo-button-theme-color-on-surface: #{k-color(#{$default-theme-color}-on-surface)};
        --kendo-button-theme-color-hover: #{k-color(#{$default-theme-color}-hover)};
        --kendo-button-theme-color-active: #{k-color(#{$default-theme-color}-active)};

        @each $name, $color in $theme-colors {
            &.k-button-#{$name} {
                --kendo-button-theme-color: #{k-color($name)};
                --kendo-button-on-theme-color: #{k-color(on-#{$name})};
                --kendo-button-theme-color-on-surface: #{k-color(#{$name}-on-surface)};
                --kendo-button-theme-color-hover: #{k-color(#{$name}-hover)};
                --kendo-button-theme-color-active: #{k-color(#{$name}-active)};
            }
        }
    }
}

@mixin kendo-button-fill-modes-controller() {
    .k-button {
        --kendo-button-text: var(--kendo-button-on-theme-color);
        --kendo-button-bg: var(--kendo-button-theme-color);
        --kendo-button-border: var(--kendo-button-theme-color);
        --kendo-button-hover-text: var(--kendo-button-on-theme-color);
        --kendo-button-hover-bg: var(--kendo-button-theme-color-hover);
        --kendo-button-hover-border: var(--kendo-button-theme-color-hover);
        --kendo-button-active-text: var(--kendo-button-on-theme-color);
        --kendo-button-active-bg: var(--kendo-button-theme-color-active);
        --kendo-button-active-border: var(--kendo-button-theme-color-active);

        // Solid fillmode
        &.k-button-solid {
            --kendo-button-text: var(--kendo-button-on-theme-color);
            --kendo-button-bg: var(--kendo-button-theme-color);
            --kendo-button-border: var(--kendo-button-theme-color);
            --kendo-button-hover-text: var(--kendo-button-on-theme-color);
            --kendo-button-hover-bg: var(--kendo-button-theme-color-hover);
            --kendo-button-hover-border: var(--kendo-button-theme-color-hover);
            --kendo-button-active-text: var(--kendo-button-on-theme-color);
            --kendo-button-active-bg: var(--kendo-button-theme-color-active);
            --kendo-button-active-border: var(--kendo-button-theme-color-active);
        }

        // Outline fillmode
        &.k-button-outline {
            --kendo-button-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-bg: transparent;
            --kendo-button-border: currentColor;
            --kendo-button-hover-text: var(--kendo-button-on-theme-color);
            --kendo-button-hover-bg: var(--kendo-button-theme-color);
            --kendo-button-hover-border: var(--kendo-button-theme-color);
            --kendo-button-active-text: var(--kendo-button-on-theme-color);
            --kendo-button-active-bg: var(--kendo-button-theme-color);
            --kendo-button-active-border: var(--kendo-button-theme-color);
        }

        // Flat fillmode
        &.k-button-flat {
            --kendo-button-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-bg: transparent;
            --kendo-button-border: transparent;
            --kendo-button-hover-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-hover-bg: transparent;
            --kendo-button-hover-border: transparent;
            --kendo-button-active-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-active-bg: transparent;
            --kendo-button-active-border: transparent;
        }

        // Link fillmode
        &.k-button-link {
            --kendo-button-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-bg: transparent;
            --kendo-button-border: transparent;
            --kendo-button-hover-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-hover-bg: transparent;
            --kendo-button-hover-border: transparent;
            --kendo-button-active-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-active-bg: transparent;
            --kendo-button-active-border: transparent;
        }

        // Clear fillmode
        &.k-button-clear {
            --kendo-button-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-bg: transparent;
            --kendo-button-border: transparent;
            --kendo-button-hover-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-hover-bg: transparent;
            --kendo-button-hover-border: transparent;
            --kendo-button-active-text: var(--kendo-button-theme-color-on-surface);
            --kendo-button-active-bg: transparent;
            --kendo-button-active-border: transparent;
        }
    }
}

@mixin kendo-button--theme-base() {
    @include kendo-button-theme-colors-controller($kendo-button-theme-colors, base);
    @include kendo-button-fill-modes-controller();

    // Apply CSS properties from variables
    .k-button {
        color: var(--kendo-button-text);
        background-color: var(--kendo-button-bg);
        border-color: var(--kendo-button-border);
        @include box-shadow($kendo-button-shadow);

        // Hover state
        &:hover,
        &.k-hover {
            color: var(--kendo-button-hover-text);
            background-color: var(--kendo-button-hover-bg);
            border-color: var(--kendo-button-hover-border);
            @include box-shadow($kendo-button-hover-shadow);
        }

        // Focus state
        &:focus,
        &.k-focus {
            @include focus-indicator($kendo-button-focus-shadow, true, true);
        }

        // Active state
        &:active,
        &.k-active {
            color: var(--kendo-button-active-text);
            background-color: var(--kendo-button-active-bg);
            border-color: var(--kendo-button-active-border);
            @include box-shadow($kendo-button-active-shadow);
        }

        // Selected state
        &.k-selected {
            color: var(--kendo-button-active-text);
            background-color: var(--kendo-button-active-bg);
            border-color: var(--kendo-button-active-border);
            @include box-shadow($kendo-button-selected-shadow);
        }

        // Disabled state
        &:disabled,
        &.k-disabled {
            color: $kendo-button-disabled-text;
            background-color: $kendo-button-disabled-bg;
            border-color: $kendo-button-disabled-border;
            @include box-shadow($kendo-button-disabled-shadow);
        }
    }
}

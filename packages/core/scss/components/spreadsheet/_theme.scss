@use "../../mixins/index.import.scss" as *;
@use "../../color-system/_functions.import.scss" as *;
@use "./variables.scss" as *;
@use "../button/_variables.scss" as *;
@use "../list/_variables.scss" as *;

@mixin kendo-spreadsheet--theme-base() {

    // Spreadsheet
    .k-spreadsheet {
        color: $kendo-spreadsheet-text;
        background-color: $kendo-spreadsheet-bg;
        border-color: $kendo-spreadsheet-border;
    }

    // Header
    .k-spreadsheet-header {
        color: $kendo-spreadsheet-header-text;
        background-color: $kendo-spreadsheet-header-bg;
        border-color: $kendo-spreadsheet-header-border;
        @include linear-gradient($kendo-spreadsheet-header-gradient);
    }

    // Row / Column Headers
    .k-spreadsheet-top-corner,
    .k-spreadsheet-row-header,
    .k-spreadsheet-column-header {
        color: $kendo-spreadsheet-table-header-text;
        background-color: $kendo-spreadsheet-table-header-bg;
        border-color: $kendo-spreadsheet-table-header-border;
        @include linear-gradient($kendo-spreadsheet-table-header-gradient);
    }

    // Cell editor
    .k-spreadsheet-cell-editor {
    }

    // Cells
    .k-spreadsheet-merged-cell {
        background-color: $kendo-spreadsheet-bg ;
    }
    .k-spreadsheet-disabled-mask {
        background-color: $kendo-spreadsheet-bg ;
    }

    // Selection
    .k-spreadsheet .k-selection-full,
    .k-spreadsheet .k-selection-partial {
        background-color: $kendo-spreadsheet-partial-selection-bg ;
    }
    .k-spreadsheet-selection {
        color: $kendo-spreadsheet-selection-text;
        background-color: $kendo-spreadsheet-selection-bg;
        border-color: $kendo-spreadsheet-selection-border;
        @include box-shadow( $kendo-spreadsheet-selection-shadow );
    }
    .k-spreadsheet-selection-highlight {
        border-color: $kendo-spreadsheet-selection-border ;
    }
    .k-spreadsheet .k-single-selection::after {
    }
    .k-spreadsheet-active-cell {
        background-color: $kendo-spreadsheet-active-cell-bg ;
        @include box-shadow( $kendo-spreadsheet-active-cell-shadow );
    }

    .k-spreadsheet .k-auto-fill {
        color: $kendo-spreadsheet-auto-fill-text;
        background-color: $kendo-spreadsheet-auto-fill-bg;
        border-color: $kendo-spreadsheet-auto-fill-border;
        @include box-shadow( $kendo-spreadsheet-auto-fill-shadow );
    }
    .k-spreadsheet .k-auto-fill-punch {
        background-color: $kendo-spreadsheet-auto-fill-punch-bg ;
    }

    // Resize handle
    .k-spreadsheet .k-resize-handle,
    .k-spreadsheet .k-resize-hint-handle,
    .k-spreadsheet .k-resize-hint-marker {
        background-color: $kendo-spreadsheet-resize-handle-bg ;
    }

    // Comments
    .k-spreadsheet-has-comment::after {
        border-block-color: $kendo-spreadsheet-cell-comment-border transparent;
        border-inline-color: transparent $kendo-spreadsheet-cell-comment-border;
    }

    // Validation
    .k-spreadsheet-cell .k-dirty {
        border-block-color: $kendo-spreadsheet-cell-dirty-border transparent;
        border-inline-color: $kendo-spreadsheet-cell-dirty-border transparent;
    }

    // Filter button
    .k-spreadsheet .k-filter-range {
        border-color: k-color(primary);
    }
    // Spreadsheet filter base styles
    .k-spreadsheet-filter {
        color: $kendo-button-text;
        background-color: $kendo-button-bg;
        border-color: $kendo-button-border;
        @include linear-gradient($kendo-button-gradient);
        box-shadow: inset 0 0 0 1px $kendo-button-border;
    }

    // Spreadsheet filter hover state
    .k-spreadsheet-filter:hover {
        color: $kendo-button-hover-text;
        background-color: $kendo-button-hover-bg;
        border-color: $kendo-button-hover-border;
        @include linear-gradient($kendo-button-hover-gradient);
    }

    // Spreadsheet filter active state
    .k-spreadsheet-filter.k-active {
        color: $kendo-button-active-text;
        background-color: $kendo-button-active-bg;
        border-color: $kendo-button-active-border;
        @include linear-gradient($kendo-button-active-gradient);
    }

    // Filter menu legacy - delete after new rendering adoption R3 23
    .k-spreadsheet-filter-menu {
        > .k-menu,
        > .k-menu:not(.k-context-menu) {

            .k-item:hover,
            .k-item.k-hover {
                color: $kendo-list-item-hover-text;
                background-color: $kendo-list-item-hover-bg;
            }
        }

        .k-spreadsheet-value-treeview-wrapper {
            color: $kendo-spreadsheet-text;
        background-color: $kendo-spreadsheet-bg;
        border-color: $kendo-spreadsheet-border;
        }
    }

    // Delete after new rendering adoption R3 23
    .k-spreadsheet-insert-image-dialog {
        border-color: $kendo-spreadsheet-insert-image-dialog-preview-border;

        .k-spreadsheet-has-image {
            &:hover,
            &.k-hover {
                box-shadow: $kendo-spreadsheet-insert-image-dialog-preview-overlay-shadow;
            }

            &:hover div,
            &.k-hover div {
                color: $kendo-spreadsheet-insert-image-dialog-overlay-hover-text;
            }
        }
    }

    // Drawing
    .k-spreadsheet-drawing {
        &.k-spreadsheet-active-drawing {
            outline-color: $kendo-spreadsheet-drawing-handle-outline-color;
        }

        .k-spreadsheet-drawing-handle {
            border-color: $kendo-spreadsheet-drawing-handle-border-color;
            background-color: $kendo-spreadsheet-drawing-handle-bg;
        }
    }

    .k-spreadsheet-drawing-anchor-cell {
        background: $kendo-spreadsheet-drawing-anchor-bg;
    }

    // Formula bar
    // .k-spreadsheet-formula-list - placeholder for future styling
    .k-syntax-ref { color: #ff8822; }
    .k-syntax-num { color: #0099ff; }
    .k-syntax-str { color: #38b714; }
    .k-syntax-error { color: red; }
    .k-syntax-bool { color: #a9169c; }
    .k-syntax-paren-match { background-color: #caf200; }

}

@mixin kendo-spreadsheet--theme() {
    @include kendo-spreadsheet--theme-base();
}
